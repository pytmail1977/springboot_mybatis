<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.iscas.tj2.pyt.springboot_mybatis.dao.ProjectMapper">
  <resultMap id="BaseResultMap" type="org.iscas.tj2.pyt.springboot_mybatis.domain.Project">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Dec 03 18:53:01 CST 2018.
    -->
    <constructor>
      <idArg column="Id_Project" javaType="java.lang.Integer" jdbcType="INTEGER" />
      <arg column="Name_Project" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="Db_Project" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="CreateDate_Project" javaType="java.util.Date" jdbcType="TIMESTAMP" />
      <arg column="ModifyDate_Project" javaType="java.util.Date" jdbcType="TIMESTAMP" />
      <arg column="Version_Project" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="Memo_Project" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="Status_Project" javaType="java.lang.Integer" jdbcType="INTEGER" />
      <arg column="Opensource_Project" javaType="java.lang.Integer" jdbcType="INTEGER" />
      <arg column="Request_Project" javaType="java.lang.String" jdbcType="VARCHAR" />
    </constructor>
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Dec 03 18:53:01 CST 2018.
    -->
    Id_Project, Name_Project, Db_Project, CreateDate_Project, ModifyDate_Project, Version_Project, 
    Memo_Project, Status_Project, Opensource_Project, Request_Project
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Dec 03 18:53:01 CST 2018.
    -->
    select 
    <include refid="Base_Column_List" />
    from Project
    where Id_Project = #{idProject,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Dec 03 18:53:01 CST 2018.
    -->
    delete from Project
    where Id_Project = #{idProject,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="org.iscas.tj2.pyt.springboot_mybatis.domain.Project">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Dec 03 18:53:01 CST 2018.
    -->
    insert into Project (Id_Project, Name_Project, Db_Project, 
      CreateDate_Project, ModifyDate_Project, 
      Version_Project, Memo_Project, Status_Project, 
      Opensource_Project, Request_Project)
    values (#{idProject,jdbcType=INTEGER}, #{nameProject,jdbcType=VARCHAR}, #{dbProject,jdbcType=VARCHAR}, 
      #{createdateProject,jdbcType=TIMESTAMP}, #{modifydateProject,jdbcType=TIMESTAMP}, 
      #{versionProject,jdbcType=VARCHAR}, #{memoProject,jdbcType=VARCHAR}, #{statusProject,jdbcType=INTEGER}, 
      #{opensourceProject,jdbcType=INTEGER}, #{requestProject,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="org.iscas.tj2.pyt.springboot_mybatis.domain.Project" useGeneratedKeys="true" keyProperty="idProject">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Dec 03 18:53:01 CST 2018.
    -->
    insert into Project
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="idProject != null">
        Id_Project,
      </if>
      <if test="nameProject != null">
        Name_Project,
      </if>
      <if test="dbProject != null">
        Db_Project,
      </if>
      <if test="createdateProject != null">
        CreateDate_Project,
      </if>
      <if test="modifydateProject != null">
        ModifyDate_Project,
      </if>
      <if test="versionProject != null">
        Version_Project,
      </if>
      <if test="memoProject != null">
        Memo_Project,
      </if>
      <if test="statusProject != null">
        Status_Project,
      </if>
      <if test="opensourceProject != null">
        Opensource_Project,
      </if>
      <if test="requestProject != null">
        Request_Project,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="idProject != null">
        #{idProject,jdbcType=INTEGER},
      </if>
      <if test="nameProject != null">
        #{nameProject,jdbcType=VARCHAR},
      </if>
      <if test="dbProject != null">
        #{dbProject,jdbcType=VARCHAR},
      </if>
      <if test="createdateProject != null">
        #{createdateProject,jdbcType=TIMESTAMP},
      </if>
      <if test="modifydateProject != null">
        #{modifydateProject,jdbcType=TIMESTAMP},
      </if>
      <if test="versionProject != null">
        #{versionProject,jdbcType=VARCHAR},
      </if>
      <if test="memoProject != null">
        #{memoProject,jdbcType=VARCHAR},
      </if>
      <if test="statusProject != null">
        #{statusProject,jdbcType=INTEGER},
      </if>
      <if test="opensourceProject != null">
        #{opensourceProject,jdbcType=INTEGER},
      </if>
      <if test="requestProject != null">
        #{requestProject,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="org.iscas.tj2.pyt.springboot_mybatis.domain.Project">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Dec 03 18:53:01 CST 2018.
    -->
    update Project
    <set>
      <if test="nameProject != null">
        Name_Project = #{nameProject,jdbcType=VARCHAR},
      </if>
      <if test="dbProject != null">
        Db_Project = #{dbProject,jdbcType=VARCHAR},
      </if>
      <if test="createdateProject != null">
        CreateDate_Project = #{createdateProject,jdbcType=TIMESTAMP},
      </if>
      <if test="modifydateProject != null">
        ModifyDate_Project = #{modifydateProject,jdbcType=TIMESTAMP},
      </if>
      <if test="versionProject != null">
        Version_Project = #{versionProject,jdbcType=VARCHAR},
      </if>
      <if test="memoProject != null">
        Memo_Project = #{memoProject,jdbcType=VARCHAR},
      </if>
      <if test="statusProject != null">
        Status_Project = #{statusProject,jdbcType=INTEGER},
      </if>
      <if test="opensourceProject != null">
        Opensource_Project = #{opensourceProject,jdbcType=INTEGER},
      </if>
      <if test="requestProject != null">
        Request_Project = #{requestProject,jdbcType=VARCHAR},
      </if>
    </set>
    where Id_Project = #{idProject,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="org.iscas.tj2.pyt.springboot_mybatis.domain.Project">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Dec 03 18:53:01 CST 2018.
    -->
    update Project
    set Name_Project = #{nameProject,jdbcType=VARCHAR},
      Db_Project = #{dbProject,jdbcType=VARCHAR},
      CreateDate_Project = #{createdateProject,jdbcType=TIMESTAMP},
      ModifyDate_Project = #{modifydateProject,jdbcType=TIMESTAMP},
      Version_Project = #{versionProject,jdbcType=VARCHAR},
      Memo_Project = #{memoProject,jdbcType=VARCHAR},
      Status_Project = #{statusProject,jdbcType=INTEGER},
      Opensource_Project = #{opensourceProject,jdbcType=INTEGER},
      Request_Project = #{requestProject,jdbcType=VARCHAR}
    where Id_Project = #{idProject,jdbcType=INTEGER}
  </update>
  
  <!-- 自己加的 -->
  <select id="selectProjectsByWeixinId" parameterType="java.lang.String" resultMap="BaseResultMap">
	SELECT Project.* 
	FROM User,Role,UserRoleRelation,Permission,RolePRMSRelation,Project
	WHERE User.WeixinId_User = #{weixinId,jdbcType=VARCHAR}
		AND User.Id_User = UserRoleRelation.Id_User 
		AND UserRoleRelation.Id_Role = Role.Id_Role 
		AND Role.Id_Role = RolePRMSRelation.Id_Role 
		AND RolePRMSRelation.Id_Permission = Permission.Id_Permission 
		AND Permission.Id_Project = Project.Id_Project
  </select>

  <!-- 2018-11-19 自己加的 -->
<!--   <select id="selectProjectsByUserId" parameterType="java.lang.Integer" resultMap="BaseResultMap">
		SELECT Project.*
		FROM User,Role,UserRoleRelation,Permission,RolePRMSRelation,Project
		WHERE User.Id_User = #{IdUser,jdbcType=INTEGER}
		AND User.Id_User = UserRoleRelation.Id_User
		AND UserRoleRelation.Id_Role = Role.Id_Role
		AND Role.Id_Role = RolePRMSRelation.Id_Role
		AND RolePRMSRelation.Id_Permission = Permission.Id_Permission
		AND Permission.Id_Project = Project.Id_Project
  </select> -->
  <!-- 2018-12-07 改为只选取自己创建和得到授权的 -->
  <select id="selectProjectsByUserId" parameterType="java.lang.Integer" resultMap="BaseResultMap">
		SELECT Project.*
		FROM User,Role,UserRoleRelation,Permission,RolePRMSRelation,Project
		WHERE User.Id_User = #{IdUser,jdbcType=INTEGER}
		AND User.Id_User = UserRoleRelation.Id_User
		AND UserRoleRelation.Id_Role = Role.Id_Role
		AND Role.Id_Role = RolePRMSRelation.Id_Role
		AND RolePRMSRelation.Id_Permission = Permission.Id_Permission
		AND Permission.Id_Project = Project.Id_Project
		AND Permission.Right_Permission in (0,1)
  </select>
  
  <!-- 2018-12-07 新增只选取自己创建的 -->
  <select id="selectSelfCreatedProjectsByUserId" parameterType="java.lang.Integer" resultMap="BaseResultMap">
		SELECT Project.*
		FROM User,Role,UserRoleRelation,Permission,RolePRMSRelation,Project
		WHERE User.Id_User = #{IdUser,jdbcType=INTEGER}
		AND User.Id_User = UserRoleRelation.Id_User
		AND UserRoleRelation.Id_Role = Role.Id_Role
		AND Role.Id_Role = RolePRMSRelation.Id_Role
		AND RolePRMSRelation.Id_Permission = Permission.Id_Permission
		AND Permission.Id_Project = Project.Id_Project
		AND Permission.Right_Permission = 0
  </select>

</mapper>